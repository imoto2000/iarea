
require File.expand_path(File.dirname(__FILE__) + '/spec_helper')

describe "IArea" do
  before do
    @lat = 35.708057
    @lng = 139.75222
  end
  
  it "should load module" do
    IArea.should be_a_kind_of(Module)
  end

  it "should load data" do
    IArea.load!
    IArea::Record.to_yml.should_not be_nil
  end

  it "convert 1st mesh" do
    IArea::Mesh.latlng2mesh(@lat,@lng,3).should =~ /^\d{7}$/
    IArea::Mesh.latlng2mesh(@lat,@lng,4).should =~ /^\d{8}$/
  end

  context "degree is under 2" do 
    it "should return 2nd degree mesh" do
      IArea::Mesh.latlng2mesh(@lat,@lng,-2).should =~ /^\d{6}$/
    end
  end

  context "get iarea record" do
    it "should get iarea record" do
      IArea.find(@lat,@lng).should be_a_kind_of IArea::Record
    end
  end
end
